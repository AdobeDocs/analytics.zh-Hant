---
description: 您可用來最佳化 Report Builder 遞送的方式，以及偶而會發生的錯誤訊息清單。
title: Report Builder 的疑難排解和最佳作法
topic: Report builder
uuid: 36a08143-dc78-40f5-9ce9-7d16980aa27b
translation-type: ht
source-git-commit: dabaf6247695bc4f3d9bfe668f3ccfca12a52269

---


# Report Builder 的疑難排解和最佳作法

您可用來最佳化 Report Builder 遞送的方式，以及偶而會發生的錯誤訊息清單。

## Report Builder 5.0 使用者和開啟 5.1 活頁簿 {#section_C29898775999453FABB5FB0E098415C8}

Adobe 將維度和分類間的分隔符號從底線字元 (_) 變更為 ||。此項變更是為了讓 Report Builder 5.0 使用者在開啟具有分類請求的 Report Builder v5.1 活頁簿時能夠相容。每次開啟 v5.1 之前版本的活頁簿時，其中的所有序列化分類請求都會轉換為這個格式。

這會造成往後相容問題：轉換為 v5.1 後，如果將活頁簿與 Report Builder v5.0 的使用者共用，該使用者將無法辨識分類請求 (事實上，它會尋找 &quot;_&quot; 而非 v5.1 序列化 &quot;||&quot;）。

在開啟具有分類請求的 ARB v5.1 活頁簿時，您會遇到以下副作用：

* 開啟活頁簿時，畫面出現以下警示訊息：「此活頁簿上次使用 Report Builder v5.1 儲存。此版本的部分功能與本電腦安裝的 Report Builder 版本不相容。強烈建議您升級為最新版 Report Builder，再更新此活頁簿。」
* 如果您以滑鼠右鍵按一下具分類的 ARB 請求，不會顯示 Report Builder 快顯功能表 (編輯請求、新增相依請求...)。
* 如果透過按一下第三個按鈕或重新整理「請求管理員」表單中的一組請求，來執行「重新整理所有」，分類請求可以順利執行，不會發生錯誤。但是，無法寫出分類值。
* 您仍然可以編輯請求，方法是開啟「請求管理員」，接著一列一列往下，直到到達正確的請求。
* 如果您編輯請求並將所有參數保持不變，接著按一下「完成」，就能正確寫出回應。編輯請求可以解決問題，是因為會重新序列化「回應配置」參數。所以此問題有解決辦法，只是較為耗時。

## Report Builder 中的驗證問題 {#section_FD79104DF1414FE2B36591606C963DE6}

Report Builder 需要驗證身分，才能從您的報表套裝中建立資料請求。視您在 [!DNL Analytics] 內的設定或您的網路而定，登入 Report Builder 有時會發生問題。

**無效的登入公司**

此錯誤最常起因於輸入的登入公司不正確，或發生網路活動問題。請執行下列動作：

* 檢查登入公司拼字，確定沒有打錯字或錯誤空格。
* 請使用相同登入公司來登入 Analytics，以確保登入公司正確無誤。如果無法以這些憑證登入，請聯絡貴公司的管理員以取得正確的登入公司。

**防火牆**

Report Builder 使用連接埠 80 和 443。請確定已允許這些連接埠通過您組織的防火牆。請參閱 Adobe 的「內部 IP 位址」，了解其他防火牆排除項目。

## 請求最佳化建議 {#section_33EF919255BF46CD97105D8ACB43573F}

以下因素可能會增加請求複雜度，並導致處理延遲。

**導致遞送延遲的因素**

* 將太多書籤、控制面板及 Report Builder 活頁簿排定在幾小時內完成。
* 將太多 Report Builder 活頁簿排定在幾乎同一時間內完成。當這種情況發生時，報表 API 佇列便會積壓下來。

**可能會減緩活頁簿執行階段效率的因素**

* 分類數量大幅增加。
* 一段時間後請求的日期範圍增加。

   **範例**：假設您使用目前的年份設定建立趨勢化請求，並依「日」細分。到了年末，請求所傳回的期間，會多於年初時建立的期間。

   `(January 1 - January 30 versus January 1 - December 31.)`

**導致活頁簿遞送失敗的原因**

活頁簿中複雜的 Excel 公式，特別是涉及日期與時間的公式。

**儲存格傳回 0 (沒有值)**

Excel 工作表名稱具有撇號或單引號，會造成 Report Builder 無法傳回值。(此為 Microsoft Excel 的限制)。

**個別請求效能**

處理速度可能受到下列設定影響：

| 設定 | 較快的效能 | 較慢的效能 |
|--- |--- |--- |
| 劃分項目與劃分順序 | 少數 | 許多 |
|  | 範例：若您由 A 到 Z 細分，則 A 的項目數一律少於 Z 的項目數。如果是相反情況，則請求時間可能會大幅增加。 |
| 日期範圍 | 小範圍 | 大範圍 |
| 篩選 | 特定篩選 | 最受歡迎篩選 |
| 粒度 | 彙總 | 每小時<ul><li>每日</li><li>每週</li><li>每月</li><li>每季</li><li>每年</li></ul> |
| 項目數 | 小量資料集 | 大量資料集 |


**排程時間**

24 小時期間內的交錯排程 (請參見下表)。將現有書籤、控制面板及 Report Builder 活頁簿排得太接近，可能會引發延遲。

在凌晨時排定較大、較複雜的請求，以允許在營業日進行手動提取與重新整理作業。

| 排程時間 | 早上 1 點 – 早上 2 點 | 早上 2 點 – 早上 7 點 | 早上 7 點 – 下午 6 點 | 下午 6 點 – 午夜 |
|--- |--- |--- |--- |--- |
| Report Builder 使用狀況 | 安靜 | 很忙碌 | 用戶端用法。<br>在本機重新整理且請求「立即傳送」的使用者數量較多時。<br>此外，請確認當排程的活頁簿逾時之際，API 佇列是否已清除。 | 不忙碌 |

**逾時**

四小時後，所有排程報表都會逾時。系統會再嘗試排程三次，而且可能導致失敗(一般而言，當資料集越大，所需執行時間就會越久)。[!DNL Analytics] 報表與 Report Builder 會顯示下列項目：

* [!DNL Analytics]：**[!UICONTROL Favorites]** > **[!UICONTROL Scheduled Reports]**

* Report Builder：在 Excel 的「[!UICONTROL Add-ins]」索引標籤中，按一下「**[!UICONTROL Management]**」。

## 錯誤訊息說明 {#section_3DF3A1EEDAD149CB941BEABEF948A4A5}

以下是在使用 Report Builder 時偶爾會顯示的錯誤訊息清單。

>[!NOTE] 以下內容只是錯誤訊息的選集，並非完整清單。如需解決錯誤的詳細資訊，請聯絡管理員。

**此功能只適用於已開啟的活頁簿。**

如果未在 Excel 中開啟任何活頁簿 (試算表文件)，且您按一下 Report Builder 工具列中的任一個圖示時，此訊息便會出現。此外，工具列將成為停用狀態，直到您開啟試算表為止。然而，在工具列仍為啟用狀態時，您可以按一下線上說明圖示而不致發生此錯誤。

**您必須先退出[!UICONTROL Request Wizard]才能啟動[!UICONTROL Request Manager]。**

雖然[!UICONTROL Request Manager]和[!UICONTROL Request Wizard]在功能上有所關聯，但是您必須先完成或取消在[!UICONTROL Request Wizard]中採取的動作，才能開始使用[!UICONTROL Request Manager]。

**無任何請求與此範圍相關聯。**

試算表的儲存格內沒有任何請求時，如果您按一下[!UICONTROL Request Manager]中的「[!UICONTROL From Sheet]」按鈕，畫面就會顯示此錯誤訊息。

若要識別試算表中含有請求的儲存格，請在[!UICONTROL Request Manager]中按一下表格列示的個別請求。如果儲存格有相關聯的請求，當您選擇表格中的請求時，系統將會反白顯示儲存格。

**選擇的範圍無效。請選擇其他範圍。**

當選擇的試算表儲存格已有映射的請求時，此錯誤便會發生。請刪除映射至儲存格的請求，或選擇其他儲存格範圍來進行映射。

如果您想要刪除儲存格，請務必先找出含有請求的儲存格並刪除請求，然後再刪除儲存格 (移除列或欄)。

**使用此功能之前，請先退出目前所在的 Excel 儲存格。**

如果您處於 Excel 儲存格內的&#x200B;*編輯模式*，當您按一下任一 Report Builder 圖示時，此錯誤訊息便會出現。要在 Excel 儲存格內使用編輯模式，您必須先選擇儲存格，且游標位在儲存格內。如果直接在 Excel 頂端的「[!UICONTROL Formula]」列或「[!UICONTROL Name Box]」中輸入文字，也能進入 Excel 儲存格內的編輯模式。

**選擇的範圍與其他請求的範圍相交。請變更您的選擇。**

將一組儲存格映射至試算表時，便會發生此錯誤。

若要在新增請求前判斷哪些是已映射的儲存格，方法之一是關閉[!UICONTROL Request Wizard]，然後開啟[!UICONTROL Request Manager]。接著逐一選擇請求摘要表格中列示的項目。當您選擇清單中的請求時，系統會反白顯示試算表中含有請求映射的相應儲存格。

這是為什麼在將多個儲存格映射至多個區域前，應先考慮以反白、列或欄資訊或格式化樣式標示儲存格的原因。
